<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Valle Sanchinarro B - Fan Center</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        'valle-blue': '#004aad', 
                        'valle-accent': '#FFD700',
                        'dark-bg': '#0f172a',
                        'card-bg': '#1e293b'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #0f172a;
            color: white;
        }
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .team-logo-shadow {
            filter: drop-shadow(0 0 15px rgba(0, 74, 173, 0.6));
        }
        /* Scrollbar personalizada para la tabla */
        .scrollbar-hide::-webkit-scrollbar {
            height: 4px;
        }
        .scrollbar-hide::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 4px;
        }
        .scrollbar-hide::-webkit-scrollbar-track {
            background: transparent;
        }
    </style>
</head>
<body class="min-h-screen pb-10">

    <!-- Navbar Simple -->
    <nav class="w-full p-4 flex justify-between items-center glass-panel sticky top-0 z-50">
        <div class="font-bold text-xl tracking-wider">DEPOR<span class="text-blue-500">VALLE</span></div>
        <div class="text-xs font-semibold bg-blue-600 px-3 py-1 rounded-full uppercase tracking-widest">Grupo 9</div>
    </nav>

    <!-- Hero Section -->
    <div class="relative w-full h-64 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-blue-900 to-dark-bg opacity-90 z-10"></div>
        <img src="https://images.unsplash.com/photo-1517466787929-bc90951d0974?ixlib=rb-1.2.1&auto=format&fit=crop&w=1920&q=80" class="absolute inset-0 w-full h-full object-cover" alt="Futsal Background">
        
        <div class="absolute inset-0 z-20 flex flex-col items-center justify-center pt-8">
            <div class="w-24 h-24 bg-white rounded-full flex items-center justify-center p-2 mb-3 shadow-lg shadow-blue-500/50">
                <img id="hero-logo" src="img/escudos/Emblema_0151.jpg" onerror="this.src='https://via.placeholder.com/150?text=VALLE'" class="w-full h-full object-contain rounded-full" alt="Escudo">
            </div>
            <h1 class="text-2xl font-extrabold text-center px-4 leading-tight">EL VALLE SANCHINARRO B</h1>
            <p class="text-blue-300 text-sm mt-1">Alevín Mixto</p>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="container mx-auto px-4 -mt-8 relative z-30 space-y-6">

        <!-- 1. Stats Summary Cards -->
        <div class="grid grid-cols-3 gap-3" id="stats-container">
            <div class="glass-panel p-3 rounded-xl text-center">
                <div class="text-xs text-gray-400 uppercase">Posición</div>
                <div class="text-2xl font-bold text-white" id="stat-pos">-</div>
            </div>
            <div class="glass-panel p-3 rounded-xl text-center">
                <div class="text-xs text-gray-400 uppercase">Puntos</div>
                <div class="text-2xl font-bold text-blue-400" id="stat-pts">-</div>
            </div>
            <div class="glass-panel p-3 rounded-xl text-center">
                <div class="text-xs text-gray-400 uppercase">Racha</div>
                <div class="text-lg font-bold text-white flex justify-center gap-1" id="stat-form">
                    <!-- JS inyectará iconos -->
                </div>
            </div>
        </div>

        <!-- 2. Next Match Card -->
        <div id="next-match-card" class="bg-gradient-to-br from-blue-600 to-blue-800 rounded-2xl p-1 shadow-xl shadow-blue-900/30 hidden">
            <div class="bg-dark-bg rounded-xl p-5 relative overflow-hidden">
                <div class="absolute top-0 right-0 bg-blue-600 text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg uppercase tracking-wider">
                    PRÓXIMO ENCUENTRO
                </div>
                
                <div class="flex justify-between items-start mt-8 mb-6"> <!-- items-start para alinear arriba si los nombres tienen distinta altura -->
                    <!-- Local -->
                    <div class="flex flex-col items-center w-2/5 px-1"> <!-- w-2/5 para dar más espacio -->
                        <div class="w-16 h-16 bg-white/5 rounded-full p-2 mb-2 flex items-center justify-center shrink-0">
                            <img id="nm-local-img" src="" class="w-full h-full object-contain" onerror="this.src='https://via.placeholder.com/50'">
                        </div>
                        <!-- Quitadas restricciones de altura y line-clamp -->
                        <span id="nm-local-name" class="text-xs text-center font-bold leading-normal text-white break-words w-full">Local</span>
                    </div>
                    
                    <!-- VS -->
                    <div class="flex flex-col items-center w-1/5 pt-2"> <!-- w-1/5 para el centro -->
                        <span class="text-xs text-gray-400 mb-1 whitespace-nowrap" id="nm-jornada">J-</span>
                        <div class="text-3xl font-black text-white">VS</div>
                        <div id="nm-time" class="text-sm text-blue-400 font-bold mt-1">00:00</div>
                        <div id="nm-date" class="text-xs text-gray-500 whitespace-nowrap">DD/MM</div>
                    </div>

                    <!-- Visitante -->
                    <div class="flex flex-col items-center w-2/5 px-1">
                        <div class="w-16 h-16 bg-white/5 rounded-full p-2 mb-2 flex items-center justify-center shrink-0">
                            <img id="nm-visit-img" src="" class="w-full h-full object-contain" onerror="this.src='https://via.placeholder.com/50'">
                        </div>
                        <!-- Quitadas restricciones de altura y line-clamp -->
                        <span id="nm-visit-name" class="text-xs text-center font-bold leading-normal text-white break-words w-full">Visitante</span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="grid grid-cols-2 gap-3 mt-4">
                    <a id="btn-map" href="#" target="_blank" class="flex items-center justify-center gap-2 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg text-xs transition font-medium">
                        <i class="fa-solid fa-location-dot text-red-400"></i> Ver Mapa
                    </a>
                    <a id="btn-cal" href="#" target="_blank" class="flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-500 text-white py-2 rounded-lg text-xs transition font-medium">
                        <i class="fa-solid fa-calendar-plus"></i> Agendar
                    </a>
                </div>
                <div id="nm-location-text" class="text-center text-[10px] text-gray-500 mt-3 truncate px-2"></div>
            </div>
        </div>

        <!-- 3. Last Match Result -->
        <div id="last-match-card" class="glass-panel rounded-2xl p-0 overflow-hidden hidden">
            <div class="bg-slate-800/50 p-2 text-center border-b border-white/5 flex justify-between px-4 items-center">
                <span class="text-[10px] text-gray-400 uppercase tracking-widest font-bold">Último Resultado</span>
                <span class="text-[10px] bg-slate-700 text-white px-2 py-0.5 rounded" id="lm-jornada">Jornada -</span>
            </div>
            
            <div class="flex items-center justify-between p-5">
                <!-- Local -->
                <div class="flex flex-col items-center w-1/3 gap-2">
                    <img id="lm-local-img" src="" class="w-12 h-12 object-contain" onerror="this.src='https://via.placeholder.com/40'">
                    <span id="lm-local-name" class="text-[10px] text-center text-gray-300 font-semibold leading-tight w-full break-words">Local</span>
                </div>

                <!-- Score -->
                <div class="flex items-center gap-3 w-1/3 justify-center">
                    <span id="lm-local-score" class="text-3xl font-bold text-white">0</span>
                    <span class="text-gray-600">-</span>
                    <span id="lm-visit-score" class="text-3xl font-bold text-white">0</span>
                </div>

                <!-- Visitante -->
                <div class="flex flex-col items-center w-1/3 gap-2">
                    <img id="lm-visit-img" src="" class="w-12 h-12 object-contain" onerror="this.src='https://via.placeholder.com/40'">
                    <span id="lm-visit-name" class="text-[10px] text-center text-gray-300 font-semibold leading-tight w-full break-words">Visitante</span>
                </div>
            </div>
        </div>

        <!-- 4. Classification Table -->
        <div class="glass-panel rounded-2xl overflow-hidden">
            <div class="p-4 border-b border-gray-700 flex justify-between items-center bg-slate-900/50">
                <h3 class="text-white font-bold text-lg flex items-center gap-2">
                    <i class="fa-solid fa-ranking-star text-yellow-500"></i> Clasificación
                </h3>
                <span class="text-[10px] text-blue-400 bg-blue-900/30 px-2 py-1 rounded border border-blue-900">Grupo 9</span>
            </div>
            
            <div class="overflow-x-auto scrollbar-hide pb-2">
                <table class="w-full text-sm text-left text-gray-300 min-w-[600px]"> <!-- min-w para forzar scroll en móvil -->
                    <thead class="text-xs text-gray-400 uppercase bg-slate-800/80 sticky top-0">
                        <tr>
                            <th scope="col" class="px-3 py-3 text-center w-10">#</th>
                            <th scope="col" class="px-3 py-3 w-48">Equipo</th>
                            <th scope="col" class="px-2 py-3 text-center font-semibold text-white" title="Puntos">PTS</th>
                            <th scope="col" class="px-2 py-3 text-center" title="Jugados">J</th>
                            <th scope="col" class="px-2 py-3 text-center" title="Ganados">G</th>
                            <th scope="col" class="px-2 py-3 text-center" title="Empatados">E</th>
                            <th scope="col" class="px-2 py-3 text-center" title="Perdidos">P</th>
                            <th scope="col" class="px-2 py-3 text-center text-gray-500" title="Goles Favor">TF</th>
                            <th scope="col" class="px-2 py-3 text-center text-gray-500" title="Goles Contra">TC</th>
                            <th scope="col" class="px-2 py-3 text-center text-gray-500" title="Average">AVG</th>
                        </tr>
                    </thead>
                    <tbody id="classification-body" class="divide-y divide-gray-800">
                        <!-- Rows will be injected here -->
                    </tbody>
                </table>
            </div>
            <div class="text-center text-[10px] text-gray-600 py-2 italic sm:hidden">
                <i class="fa-solid fa-arrows-left-right mr-1"></i> Desliza para ver más datos
            </div>
        </div>

        <!-- 5. Season Timeline (History) -->
        <div class="glass-panel rounded-2xl p-5">
            <h3 class="text-white font-bold text-lg mb-6 flex items-center gap-2">
                <i class="fa-solid fa-clock-rotate-left text-blue-400"></i> Historial
            </h3>
            <div class="relative border-l-2 border-gray-700 ml-3 space-y-8" id="history-container">
                <!-- Timeline items will be injected here -->
            </div>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        const MY_TEAM = "EL VALLE SANCHINARRO \"B\"";
        const DATA_URL = "datos/clasificacion.json"; 

        let mockData = {
            "clasificacion": [
                {"Grupo": "GRUPO: 9", "Equipo": "SANTAMARCA INTERNACIONAL", "J": "4", "G": "3", "E": "0", "P": "1", "TF": "27", "TC": "13", "AVG": "14", "Puntos": "6", "Escudo": "img/escudos/Emblema_0114.jpg"},
                {"Grupo": "GRUPO: 9", "Equipo": "EL VALLE SANCHINARRO \"B\"", "J": "4", "G": "1", "E": "0", "P": "3", "TF": "27", "TC": "26", "AVG": "1", "Puntos": "2", "Escudo": "img/escudos/Emblema_0151.jpg"},
                {"Grupo": "GRUPO: 9", "Equipo": "COLEGIO ALEMAN \"A\"", "J": "3", "G": "3", "E": "0", "P": "0", "TF": "14", "TC": "7", "AVG": "7", "Puntos": "6", "Escudo": "img/escudos/Emblema_0128.jpg"}
            ],
            "jornadas": [
                {
                    "Grupo": "GRUPO: 9", "Jornada": "1", "Local": "COLEGIO ALEMAN \"A\"", "GolesLocal": "6", "Visitante": "EL VALLE SANCHINARRO \"B\"", "GolesVisitante": "5", "Fecha": "08/11/25", "Hora": "11:30", "Direccion": "MONASTERIO DE GUADALUPE, 7",
                    "EscudoLocal": "img/escudos/Emblema_0128.jpg", "EscudoVisitante": "img/escudos/Emblema_0151.jpg"
                },
                {
                    "Grupo": "GRUPO: 9", "Jornada": "2", "Local": "EL VALLE SANCHINARRO \"B\"", "GolesLocal": "10", "Visitante": "ASUNCION CUESTABLANCA \"B\"", "GolesVisitante": "2", "Fecha": "24/11/25", "Hora": "18:00", "Direccion": "VICENTE BLASCO",
                    "EscudoLocal": "img/escudos/Emblema_0151.jpg", "EscudoVisitante": "img/escudos/Emblema_0118.jpg"
                },
                {
                    "Grupo": "GRUPO: 9", "Jornada": "3", "Local": "EL VALLE SANCHINARRO \"B\"", "GolesLocal": "", "Visitante": "ASUNCION CUESTABLANCA \"B\"", "GolesVisitante": "", "Fecha": "29/11/25", "Hora": "11:15", "Direccion": "VICENTE BLASCO IBAÑEZ, S/N",
                    "EscudoLocal": "img/escudos/Emblema_0151.jpg", "EscudoVisitante": "img/escudos/Emblema_0118.jpg"
                }
            ]
        };

        // Función robusta para parsear fechas
        function parseDate(dateStr, timeStr) {
            // Si falta la fecha o la hora, devolvemos una fecha muy futura para que no rompa el ordenamiento
            if (!dateStr || !timeStr) return new Date(9999, 0, 1);
            
            const dateParts = dateStr.split('/');
            const timeParts = timeStr.split(':');

            // Verificamos que tengamos día/mes/año y hora/minuto
            if (dateParts.length !== 3 || timeParts.length < 2) {
                return new Date(9999, 0, 1);
            }

            const [day, month, year] = dateParts;
            const [hour, minute] = timeParts;
            
            // Verificamos que el año exista antes de acceder a su length
            if (!year) return new Date(9999, 0, 1);

            const fullYear = year.length === 2 ? '20' + year : year;
            return new Date(fullYear, month - 1, day, hour, minute);
        }

        function createCalendarLink(match) {
            const startDate = parseDate(match.Fecha, match.Hora);
            // Si la fecha es inválida (año 9999), no generamos enlace
            if (startDate.getFullYear() === 9999) return "#";

            const endDate = new Date(startDate.getTime() + (90 * 60000));
            const format = (d) => d.toISOString().replace(/-|:|\.\d+/g, '');
            const title = encodeURIComponent(`Partido: ${match.Local} vs ${match.Visitante}`);
            const details = encodeURIComponent(`Jornada ${match.Jornada} - Grupo 9`);
            const location = encodeURIComponent(match.Direccion);
            return `https://www.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${format(startDate)}/${format(endDate)}&details=${details}&location=${location}&sf=true&output=xml`;
        }

        function createMapLink(address) {
            return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`;
        }

        async function init() {
            let data = mockData;
            try {
                const response = await fetch(DATA_URL);
                if (response.ok) {
                    data = await response.json();
                }
            } catch (e) {
                console.log("Usando datos mock");
            }
            renderApp(data);
        }

        function renderApp(data) {
            const myTeamClean = MY_TEAM.replace(/['"]+/g, '').toUpperCase();
            
            // --- 1. CLASIFICACIÓN ---
            const groupTable = data.clasificacion.filter(row => row.Grupo.includes("9"));
            groupTable.sort((a, b) => {
                const ptsA = parseInt(a.Puntos) || 0;
                const ptsB = parseInt(b.Puntos) || 0;
                const dgA = (parseInt(a.TF) - parseInt(a.TC)) || 0;
                const dgB = (parseInt(b.TF) - parseInt(b.TC)) || 0;
                
                if (ptsB !== ptsA) return ptsB - ptsA;
                return dgB - dgA; 
            });

            const tableBody = document.getElementById('classification-body');
            let myTeamRank = 0;
            let myTeamStats = null;

            groupTable.forEach((team, index) => {
                const teamNameClean = team.Equipo.replace(/['"]+/g, '').toUpperCase();
                const isMyTeam = teamNameClean === myTeamClean;
                
                if (isMyTeam) {
                    myTeamRank = index + 1;
                    myTeamStats = team;
                }

                const row = document.createElement('tr');
                row.className = isMyTeam ? "bg-blue-900/40 border-l-4 border-blue-500" : "hover:bg-slate-800/30";
                row.innerHTML = `
                    <td class="px-3 py-3 text-center font-medium ${isMyTeam ? 'text-white' : 'text-gray-500'}">${index + 1}</td>
                    <td class="px-3 py-3 flex items-center gap-3">
                        <div class="w-8 h-8 flex-shrink-0 bg-white/5 rounded-full p-1 flex items-center justify-center">
                            <img src="${team.Escudo}" onerror="this.src='https://via.placeholder.com/30'" class="w-full h-full object-contain">
                        </div>
                        <span class="${isMyTeam ? 'font-bold text-white' : 'text-gray-300'} truncate font-medium text-xs sm:text-sm">${team.Equipo}</span>
                    </td>
                    <td class="px-2 py-3 text-center font-bold text-base ${isMyTeam ? 'text-blue-400' : 'text-white'} bg-slate-800/20">${team.Puntos}</td>
                    <td class="px-2 py-3 text-center">${team.J}</td>
                    <td class="px-2 py-3 text-center text-gray-400">${team.G}</td>
                    <td class="px-2 py-3 text-center text-gray-400">${team.E}</td>
                    <td class="px-2 py-3 text-center text-gray-400">${team.P}</td>
                    <td class="px-2 py-3 text-center text-gray-500 text-xs">${team.TF}</td>
                    <td class="px-2 py-3 text-center text-gray-500 text-xs">${team.TC}</td>
                    <td class="px-2 py-3 text-center text-gray-500 text-xs">${team.AVG}</td>
                `;
                tableBody.appendChild(row);
            });

            // Stats Header
            if (myTeamStats) {
                document.getElementById('stat-pos').textContent = myTeamRank + "º";
                document.getElementById('stat-pts').textContent = myTeamStats.Puntos;
                
                // Generar Racha visual basada en últimos partidos
                const allMyMatches = data.jornadas.filter(m => {
                    const local = m.Local.replace(/['"]+/g, '').toUpperCase();
                    const visit = m.Visitante.replace(/['"]+/g, '').toUpperCase();
                    return m.Grupo.includes("9") && (local === myTeamClean || visit === myTeamClean) && m.GolesLocal.trim() !== "";
                });
                
                // Ordenar por fecha (reciente al final) para calcular racha
                allMyMatches.forEach(m => m.dateObj = parseDate(m.Fecha, m.Hora));
                allMyMatches.sort((a, b) => a.dateObj - b.dateObj);
                
                let formHTML = '';
                // Coger los ultimos 5
                const last5 = allMyMatches.slice(-5);
                
                last5.forEach(match => {
                    const isLocal = match.Local.replace(/['"]+/g, '').toUpperCase() === myTeamClean;
                    const gl = parseInt(match.GolesLocal);
                    const gv = parseInt(match.GolesVisitante);
                    let color = 'bg-gray-500';
                    if ((isLocal && gl > gv) || (!isLocal && gv > gl)) color = 'bg-green-500';
                    else if ((isLocal && gl < gv) || (!isLocal && gv < gl)) color = 'bg-red-500';
                    
                    formHTML += `<span class="w-2 h-2 rounded-full ${color} block ring-1 ring-dark-bg"></span>`;
                });
                document.getElementById('stat-form').innerHTML = formHTML || '<span class="text-xs text-gray-500">Sin datos</span>';
            }

            // --- 2. PARTIDOS ---
            const now = new Date();
            const myMatches = data.jornadas.filter(m => {
                const local = m.Local.replace(/['"]+/g, '').toUpperCase();
                const visit = m.Visitante.replace(/['"]+/g, '').toUpperCase();
                return m.Grupo.includes("9") && (local === myTeamClean || visit === myTeamClean);
            });

            myMatches.forEach(m => m.dateObj = parseDate(m.Fecha, m.Hora));
            myMatches.sort((a, b) => a.dateObj - b.dateObj);

            let lastMatch = null;
            let nextMatch = null;

            for (let match of myMatches) {
                const hasScore = match.GolesLocal.trim() !== "" && match.GolesVisitante.trim() !== "";
                const isPast = match.dateObj < now;

                if (hasScore || (isPast && hasScore)) {
                    lastMatch = match;
                } else if (!nextMatch && match.dateObj > now) {
                    nextMatch = match;
                }
            }

            // Render Próximo
            if (nextMatch) {
                document.getElementById('next-match-card').classList.remove('hidden');
                document.getElementById('nm-local-name').textContent = nextMatch.Local;
                document.getElementById('nm-visit-name').textContent = nextMatch.Visitante;
                document.getElementById('nm-local-img').src = nextMatch.EscudoLocal;
                document.getElementById('nm-visit-img').src = nextMatch.EscudoVisitante;
                document.getElementById('nm-jornada').textContent = `JORNADA ${nextMatch.Jornada}`;
                
                document.getElementById('nm-time').textContent = nextMatch.Hora;
                document.getElementById('nm-date').textContent = nextMatch.Fecha;
                document.getElementById('nm-location-text').textContent = nextMatch.Direccion;

                document.getElementById('btn-cal').href = createCalendarLink(nextMatch);
                document.getElementById('btn-map').href = createMapLink(nextMatch.Direccion);
            } else {
                document.getElementById('next-match-card').innerHTML = `<div class="p-5 text-center text-gray-400 text-xs">No hay próximos partidos</div>`;
                document.getElementById('next-match-card').classList.remove('hidden');
            }

            // Render Último
            if (lastMatch) {
                document.getElementById('last-match-card').classList.remove('hidden');
                document.getElementById('lm-jornada').textContent = `JORNADA ${lastMatch.Jornada}`;
                
                document.getElementById('lm-local-name').textContent = lastMatch.Local;
                document.getElementById('lm-visit-name').textContent = lastMatch.Visitante;
                
                // Imágenes
                document.getElementById('lm-local-img').src = lastMatch.EscudoLocal;
                document.getElementById('lm-visit-img').src = lastMatch.EscudoVisitante;

                document.getElementById('lm-local-score').textContent = lastMatch.GolesLocal;
                document.getElementById('lm-visit-score').textContent = lastMatch.GolesVisitante;
                
                const isLocalMe = lastMatch.Local.replace(/['"]+/g, '').toUpperCase() === myTeamClean;
                const gl = parseInt(lastMatch.GolesLocal);
                const gv = parseInt(lastMatch.GolesVisitante);
                
                let resultColor = 'text-white';
                if ((isLocalMe && gl > gv) || (!isLocalMe && gv > gl)) resultColor = 'text-green-400';
                else if (gl === gv) resultColor = 'text-gray-300';
                else resultColor = 'text-red-400';

                if(isLocalMe) document.getElementById('lm-local-score').className += ` ${resultColor}`;
                else document.getElementById('lm-visit-score').className += ` ${resultColor}`;
            }

            // Render Historial
            const historyContainer = document.getElementById('history-container');
            const pastMatches = myMatches.filter(m => m.dateObj < now && m.GolesLocal !== "").reverse();

            if (pastMatches.length === 0) {
                historyContainer.innerHTML = '<div class="ml-4 text-gray-500 text-xs italic">Sin partidos anteriores</div>';
            }

            pastMatches.forEach(match => {
                const isLocalMe = match.Local.replace(/['"]+/g, '').toUpperCase() === myTeamClean;
                const gl = parseInt(match.GolesLocal);
                const gv = parseInt(match.GolesVisitante);
                
                let resultClass = 'bg-gray-600 border-gray-500'; 
                let resultLetter = 'E';
                
                if ((isLocalMe && gl > gv) || (!isLocalMe && gv > gl)) {
                    resultClass = 'bg-green-500 border-green-400';
                    resultLetter = 'V';
                } else if ((isLocalMe && gl < gv) || (!isLocalMe && gv < gl)) {
                    resultClass = 'bg-red-500 border-red-400';
                    resultLetter = 'D';
                }

                const item = document.createElement('div');
                item.className = "mb-8 ml-6 relative";
                item.innerHTML = `
                    <span class="absolute -left-[35px] top-0 flex items-center justify-center w-8 h-8 ${resultClass} border-2 rounded-full shadow-lg text-xs font-bold text-white z-10">
                        ${resultLetter}
                    </span>
                    
                    <div class="bg-card-bg/50 p-3 rounded-lg border border-white/5">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] text-blue-400 font-bold bg-blue-900/20 px-2 rounded">JORNADA ${match.Jornada}</span>
                            <time class="text-[10px] text-gray-500">${match.Fecha}</time>
                        </div>

                        <div class="flex items-center justify-between gap-2">
                            <!-- Local -->
                            <div class="flex flex-col items-center flex-1">
                                <img src="${match.EscudoLocal}" class="w-8 h-8 object-contain mb-1 opacity-80">
                                <span class="text-[10px] text-gray-400 text-center leading-none line-clamp-1 w-full">${match.Local}</span>
                            </div>

                            <div class="text-xl font-bold text-white whitespace-nowrap bg-dark-bg px-3 py-1 rounded">
                                ${match.GolesLocal} - ${match.GolesVisitante}
                            </div>

                            <!-- Visit -->
                            <div class="flex flex-col items-center flex-1">
                                <img src="${match.EscudoVisitante}" class="w-8 h-8 object-contain mb-1 opacity-80">
                                <span class="text-[10px] text-gray-400 text-center leading-none line-clamp-1 w-full">${match.Visitante}</span>
                            </div>
                        </div>
                    </div>
                `;
                historyContainer.appendChild(item);
            });
        }

        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>