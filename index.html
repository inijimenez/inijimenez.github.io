<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard Alevín Mixto - G9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f1f5f9; -webkit-tap-highlight-color: transparent; }
        .fade-in { animation: fadeIn 0.5s ease-in-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .header-bg { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .tab-active { background-color: #1e3a8a; color: white; box-shadow: 0 4px 12px rgba(30, 58, 138, 0.2); }
        .tab-inactive { background-color: white; color: #64748b; border: 1px solid #e2e8f0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .loader { border: 2px solid #f3f3f3; border-top: 2px solid #3b82f6; border-radius: 50%; width: 14px; height: 14px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen pb-10">

    <!-- HEADER -->
    <header class="header-bg text-white pt-6 pb-20 px-6 rounded-b-[3rem] shadow-xl relative overflow-hidden">
        <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full translate-x-1/4 -translate-y-1/4 blur-3xl"></div>
        <div class="absolute bottom-0 left-0 w-32 h-32 bg-blue-400 opacity-10 rounded-full -translate-x-1/4 translate-y-1/4 blur-2xl"></div>

        <div class="relative z-10">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <div class="flex items-center gap-2 mb-2">
                        <span class="inline-block bg-white/20 backdrop-blur-sm border border-white/10 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest shadow-sm">Temporada 2025/26</span>
                        <!-- Indicador de Estado Discreto -->
                        <div id="status-pill" class="hidden flex items-center gap-1 bg-black/20 px-2 py-1 rounded-full">
                            <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                            <span class="text-[9px] font-bold uppercase opacity-90">Live</span>
                        </div>
                    </div>
                    <h1 class="text-2xl font-black leading-tight">Grupo 9 <br><span class="text-blue-200 font-medium text-lg">Alevín Mixto</span></h1>
                </div>
                <!-- Logo ECM Restaurado -->
                <div class="bg-white p-2 rounded-2xl border border-white/20 shadow-inner backdrop-blur-md h-14 w-14 flex items-center justify-center relative group">
                   <img src="https://www2.ecmadrid.org/Deportesdev/Images/logo_ECM.jpg" 
                        alt="ECM" 
                        class="h-full w-auto object-contain"
                        onerror="this.style.display='none'; this.parentNode.innerHTML='<i class=\'fa-solid fa-trophy text-yellow-500 text-2xl\'></i>'">
                    
                    <!-- Loading Spinner Overlay (Solo mientras carga) -->
                    <div id="logo-loader" class="absolute inset-0 flex items-center justify-center bg-white/80 rounded-2xl">
                        <div class="loader"></div>
                    </div>
                </div>
            </div>

            <!-- TARJETA PRÓXIMO PARTIDO -->
            <div id="next-match-card" class="bg-white text-slate-800 rounded-3xl p-5 shadow-2xl shadow-blue-900/20 relative overflow-hidden transform transition-transform active:scale-[0.99] min-h-[180px] flex flex-col justify-center">
                <p class="text-center text-gray-400 text-sm animate-pulse">
                    <i class="fa-regular fa-futbol mr-2"></i>Cargando partido...
                </p>
            </div>
        </div>
    </header>

    <!-- CONTENIDO -->
    <main class="px-4 -mt-6 relative z-20 max-w-3xl mx-auto">
        
        <!-- Tabs -->
        <div class="flex p-1 bg-white rounded-2xl shadow-lg shadow-slate-200/50 mb-6">
            <button onclick="switchTab('clasificacion')" id="tab-clasif" class="flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-active">Clasificación</button>
            <button onclick="switchTab('resultados')" id="tab-res" class="flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-inactive hover:bg-slate-50">Resultados</button>
        </div>

        <!-- CLASIFICACIÓN -->
        <div id="view-clasificacion" class="fade-in space-y-4">
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="grid grid-cols-12 bg-slate-50 p-3 text-[9px] font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100 text-center items-center">
                    <div class="col-span-1">#</div>
                    <div class="col-span-4 text-left pl-1">Equipo</div>
                    <div class="col-span-1">PJ</div>
                    <div class="col-span-1">GF</div>
                    <div class="col-span-1">GC</div>
                    <div class="col-span-2">AVG</div>
                    <div class="col-span-2">Pts</div>
                </div>
                <div id="standings-container" class="min-h-[200px]">
                    <div class="p-8 text-center text-gray-400 text-xs">
                        <i class="fa-solid fa-cloud-arrow-down text-2xl mb-2 text-blue-300"></i><br>
                        Sincronizando...
                    </div>
                </div>
            </div>
            <div id="data-source-label" class="text-center text-[10px] text-gray-400 mt-2 italic">
                Conectando...
            </div>
        </div>

        <!-- RESULTADOS -->
        <div id="view-resultados" class="hidden fade-in">
            <div class="flex items-center justify-between mb-4 pl-1">
                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Resultados del Grupo</h3>
            </div>
            <div class="space-y-4" id="matches-list"></div>
        </div>
    </main>

    <script>
        const TARGET_URL = 'https://www2.ecmadrid.org/Deportesdev/Clasificacion/_ShowClasif?numcom=89&depor=FUTBOL-SALA&categ=ALEVIN%20MIXTO';
        const PROXY_URL = 'https://api.codetabs.com/v1/proxy?quest=';
        const BASE_IMG_URL = 'https://www2.ecmadrid.org'; 
        
        let currentNextMatch = null; 

        // --- DATOS DE RESPALDO ---
        const BACKUP_TEAMS = [
            { pos: 1, name: 'FEC STA. JOAQUINA VEDRUNA "C"', pj: 2, gf: 10, gc: 3, avg: 7, pts: 4, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0061.jpg' },
            { pos: 2, name: 'COLEGIO ALEMAN "A"', pj: 2, gf: 10, gc: 7, avg: 3, pts: 4, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0128.jpg' },
            { pos: 3, name: 'LA INMACULADA P. HIERRO', pj: 3, gf: 15, gc: 18, avg: -3, pts: 4, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0144.jpg' },
            { pos: 4, name: 'SANTAMARCA INTERNACIONAL', pj: 2, gf: 12, gc: 7, avg: 5, pts: 2, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0114.jpg' },
            { pos: 5, name: 'EL VALLE SANCHINARRO "B"', pj: 3, gf: 20, gc: 17, avg: 3, pts: 2, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0151.jpg' },
            { pos: 6, name: 'SANTA MARIA LA BLANCA "A"', pj: 2, gf: 8, gc: 8, avg: 0, pts: 2, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0143.jpg' },
            { pos: 7, name: 'ASUNCION CUESTABLANCA "B"', pj: 2, gf: 6, gc: 7, avg: -1, pts: 2, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0118.jpg' },
            { pos: 8, name: 'CORAZONISTAS "A"', pj: 2, gf: 4, gc: 8, avg: -4, pts: 0, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0099.jpg' },
            { pos: 9, name: 'NTRA. SRA. CONSOLACION "B"', pj: 2, gf: 6, gc: 16, avg: -10, pts: 0, logo: '/Deportesdev//Images/WallImages/imagepath/Emblema_0076.jpg' }
        ];

        const BACKUP_MATCHES = [
            { jornada: '4', localName: 'NTRA. SRA. CONSOLACION "B"', localScore: '3', visitName: 'EL VALLE SANCHINARRO "B"', visitScore: '9', fecha: '22/11/25', hora: '12:00', localImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0076.jpg', visitImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0151.jpg', direccion: '#', addressText: 'Colegio Consolación' },
            { jornada: '3', localName: 'EL VALLE SANCHINARRO "B"', localScore: '5', visitName: 'SANTAMARCA INTERNACIONAL', visitScore: '8', fecha: '15/11/25', hora: '12:30', localImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0151.jpg', visitImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0114.jpg', direccion: '#', addressText: 'Valle Sanchinarro' },
            { jornada: '2', localName: 'CORAZONISTAS "A"', localScore: '3', visitName: 'EL VALLE SANCHINARRO "B"', visitScore: '12', fecha: '08/11/25', hora: '10:00', localImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0099.jpg', visitImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0151.jpg', direccion: '#', addressText: 'Corazonistas' },
            { jornada: '5', localName: 'EL VALLE SANCHINARRO "B"', localScore: '', visitName: 'ASUNCION CUESTABLANCA "B"', visitScore: '', fecha: '29/11/25', hora: '11:15', localImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0151.jpg', visitImg: '/Deportesdev//Images/WallImages/imagepath/Emblema_0118.jpg', direccion: 'https://maps.google.com/?q=C/ Vicente Blasco Ibáñez', addressText: 'C/ Vicente Blasco Ibáñez, S/N' }
        ];

        document.addEventListener('DOMContentLoaded', fetchData);

        async function fetchData() {
            try {
                const response = await fetch(PROXY_URL + encodeURIComponent(TARGET_URL));
                if (!response.ok) throw new Error('Fallo en Proxy');
                const data = await response.json();
                
                if(!data.contents || data.contents.length < 100) throw new Error('Contenido vacío');

                const success = parseHTML(data.contents);
                
                if (success) {
                    document.getElementById('status-pill').classList.remove('hidden');
                    document.getElementById('logo-loader').classList.add('hidden');
                    document.getElementById('data-source-label').innerText = "* Datos en tiempo real de ECMadrid";
                } else {
                    throw new Error('No se encontró el Grupo 9');
                }

            } catch (error) {
                console.warn("Fallo carga dinámica, usando backup:", error);
                loadBackupData();
            }
        }

        function loadBackupData() {
            renderStandingsUI(BACKUP_TEAMS);
            renderMatchesUI(BACKUP_MATCHES);
            document.getElementById('logo-loader').classList.add('hidden');
            const pill = document.getElementById('status-pill');
            pill.innerHTML = '<div class="w-2 h-2 rounded-full bg-orange-400"></div><span class="text-[9px] font-bold uppercase opacity-90">Offline</span>';
            pill.classList.remove('hidden');
            document.getElementById('data-source-label').innerHTML = "<span class='text-orange-500 font-bold'>!</span> Modo sin conexión: Datos guardados";
        }

        function parseHTML(htmlString) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlString, 'text/html');
            const headers = Array.from(doc.querySelectorAll('h3'));
            const groupHeader = headers.find(h => h.textContent.includes('GRUPO: 9'));

            if (!groupHeader) return false;

            const tableClasif = groupHeader.nextElementSibling;
            if (tableClasif && tableClasif.tagName === 'TABLE') {
                const teams = parseStandingsTable(tableClasif);
                renderStandingsUI(teams);
            }

            const allHeaders = headers.filter(h => h.textContent.includes('GRUPO: 9'));
            if (allHeaders.length > 1) {
                const tableRes = allHeaders[1].nextElementSibling;
                if (tableRes && tableRes.tagName === 'TABLE') {
                    const matches = parseMatchesTable(tableRes);
                    renderMatchesUI(matches);
                }
            } else {
                renderMatchesUI(BACKUP_MATCHES);
            }
            return true;
        }

        function parseStandingsTable(table) {
            const rows = Array.from(table.querySelectorAll('tr')).slice(1);
            return rows.map((row, i) => {
                const cells = row.querySelectorAll('td');
                if (cells.length < 8) return null;
                const img = cells[0].querySelector('img');
                return {
                    pos: i + 1,
                    logo: img ? img.getAttribute('src') : '',
                    name: cells[1].innerText.trim(),
                    pj: cells[2].innerText.trim(),
                    gf: cells[6].innerText.trim(),
                    gc: cells[7].innerText.trim(),
                    avg: cells[8].innerText.trim(),
                    pts: cells[9].innerText.trim()
                };
            }).filter(t => t);
        }

        function parseMatchesTable(table) {
            const rows = Array.from(table.querySelectorAll('tr')).slice(1);
            const matches = [];
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if(cells.length < 5) return;
                
                const local = cells[1].innerText.trim();
                const visit = cells[3].innerText.trim();
                
                if (local.includes('VALLE SANCHINARRO "B"') || visit.includes('VALLE SANCHINARRO "B"')) {
                    // Extraer dirección textual limpia
                    let rawAddress = cells[7]?.innerText.trim().replace('MAPA', '').trim();
                    // Si está vacía, intentar coger el link title o poner default
                    if (!rawAddress || rawAddress.length < 3) rawAddress = 'Ubicación por confirmar';

                    matches.push({
                        jornada: cells[0].innerText.trim(),
                        localName: local,
                        localScore: cells[2].innerText.trim(),
                        visitName: visit,
                        visitScore: cells[4].innerText.trim(),
                        fecha: cells[5].innerText.trim(),
                        hora: cells[6].innerText.trim(),
                        localImg: cells[1].querySelector('img')?.getAttribute('src'),
                        visitImg: cells[3].querySelector('img')?.getAttribute('src'),
                        direccion: cells[7]?.querySelector('a')?.getAttribute('href') || '#',
                        addressText: rawAddress // Guardamos la dirección real
                    });
                }
            });
            const played = matches.filter(m => m.localScore !== '').reverse();
            const pending = matches.filter(m => m.localScore === '');
            return [...pending, ...played];
        }

        function renderStandingsUI(teams) {
            const container = document.getElementById('standings-container');
            container.innerHTML = '';
            
            teams.forEach(t => {
                const isMyTeam = t.name.toUpperCase().includes("SANCHINARRO") && t.name.includes('"B"');
                const rowStyle = isMyTeam ? 'bg-indigo-50 border-l-4 border-indigo-500' : 'hover:bg-slate-50 border-l-4 border-transparent';
                const rankStyle = t.pos === 1 ? 'text-yellow-500 bg-yellow-100 rounded-full w-6 h-6 flex items-center justify-center font-bold' : 'text-slate-500 font-bold';
                const avgVal = parseInt(t.avg);
                const avgColor = avgVal > 0 ? 'text-green-600' : (avgVal < 0 ? 'text-red-500' : 'text-slate-400');
                const logoUrl = t.logo.startsWith('http') ? t.logo : BASE_IMG_URL + t.logo;

                container.innerHTML += `
                <div class="grid grid-cols-12 items-center p-3 border-b border-slate-100 text-[11px] transition-colors ${rowStyle}">
                    <div class="col-span-1 text-center flex justify-center"><div class="${rankStyle}">${t.pos}</div></div>
                    <div class="col-span-4 pl-1 pr-1 flex items-center gap-1.5 overflow-hidden">
                        <img src="${logoUrl}" class="w-5 h-5 object-contain shrink-0" onerror="this.style.display='none'">
                        <div class="font-bold text-slate-800 truncate leading-tight">${t.name}</div>
                    </div>
                    <div class="col-span-1 text-center text-slate-500 font-medium">${t.pj}</div>
                    <div class="col-span-1 text-center text-slate-600">${t.gf}</div>
                    <div class="col-span-1 text-center text-slate-400">${t.gc}</div>
                    <div class="col-span-2 text-center font-bold ${avgColor}">${t.avg}</div>
                    <div class="col-span-2 text-center font-black text-slate-900 text-sm bg-slate-200/50 rounded py-0.5 mx-1">${t.pts}</div>
                </div>`;
            });
        }

        function renderMatchesUI(matches) {
            const container = document.getElementById('matches-list');
            container.innerHTML = '';
            
            const nextMatch = matches.find(m => m.localScore === '');
            renderHeroCard(nextMatch);

            matches.forEach(m => {
                if(m.localScore === '') return;

                const isMyTeamLocal = m.localName.toUpperCase().includes("SANCHINARRO");
                const myScore = parseInt(isMyTeamLocal ? m.localScore : m.visitScore);
                const rivalScore = parseInt(isMyTeamLocal ? m.visitScore : m.localScore);
                
                let resColor, barColor;
                if (myScore > rivalScore) { resColor = 'text-green-600 bg-green-50 border-green-200'; barColor = 'bg-green-500'; }
                else if (myScore < rivalScore) { resColor = 'text-red-600 bg-red-50 border-red-200'; barColor = 'bg-red-500'; }
                else { resColor = 'text-orange-600 bg-orange-50 border-orange-200'; barColor = 'bg-orange-400'; }

                const localUrl = m.localImg.startsWith('http') ? m.localImg : BASE_IMG_URL + m.localImg;
                const visitUrl = m.visitImg.startsWith('http') ? m.visitImg : BASE_IMG_URL + m.visitImg;

                container.innerHTML += `
                <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden relative">
                    <div class="absolute left-0 top-0 bottom-0 w-1 ${barColor}"></div>
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-3 border-b border-slate-50 pb-2">
                            <span class="text-[10px] font-bold text-white bg-slate-800 px-2 py-0.5 rounded">Jornada ${m.jornada}</span>
                            <span class="text-xs text-slate-400">${m.fecha}</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex flex-col items-center w-1/3 gap-1">
                                <img src="${localUrl}" class="w-8 h-8 object-contain">
                                <span class="text-[9px] font-bold text-center leading-tight text-slate-600 truncate w-full">${m.localName}</span>
                            </div>
                            <div class="text-xl font-black ${resColor} px-3 py-1 rounded-lg border">
                                ${m.localScore} - ${m.visitScore}
                            </div>
                            <div class="flex flex-col items-center w-1/3 gap-1">
                                <img src="${visitUrl}" class="w-8 h-8 object-contain">
                                <span class="text-[9px] font-bold text-center leading-tight text-slate-600 truncate w-full">${m.visitName}</span>
                            </div>
                        </div>
                    </div>
                </div>`;
            });
        }

        function renderHeroCard(m) {
            const card = document.getElementById('next-match-card');
            if (!m) {
                card.innerHTML = '<p class="text-center text-gray-400 py-4">No hay partidos pendientes programados.</p>';
                return;
            }
            
            currentNextMatch = m;

            const localUrl = m.localImg.startsWith('http') ? m.localImg : BASE_IMG_URL + m.localImg;
            const visitUrl = m.visitImg.startsWith('http') ? m.visitImg : BASE_IMG_URL + m.visitImg;
            const addressDisplay = m.addressText.length > 25 ? m.addressText.substring(0, 22) + '...' : m.addressText;

            card.innerHTML = `
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>
                <div class="flex justify-between items-center mb-4">
                    <span class="text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded uppercase tracking-wider">Próximo Partido</span>
                    <span class="text-xs font-bold text-gray-400"><i class="fa-regular fa-calendar mr-1"></i> ${m.fecha}</span>
                </div>
                <div class="flex justify-between items-center px-2">
                    <div class="flex flex-col items-center w-1/3">
                        <span class="text-[9px] text-gray-400 font-bold tracking-widest mb-1">LOCAL</span>
                        <div class="w-14 h-14 rounded-full bg-white border border-indigo-100 p-1 shadow-md mb-2 flex items-center justify-center">
                            <img src="${localUrl}" class="w-full h-full object-contain">
                        </div>
                        <span class="text-[10px] font-bold text-center leading-tight text-slate-800">${m.localName}</span>
                    </div>
                    <div class="flex flex-col items-center w-1/3">
                        <span class="text-3xl font-black text-slate-800 tracking-tighter">${m.hora}</span>
                        <span class="text-[10px] text-gray-400 uppercase font-bold mt-1 bg-gray-100 px-2 py-0.5 rounded-full">Jornada ${m.jornada}</span>
                    </div>
                    <div class="flex flex-col items-center w-1/3">
                        <span class="text-[9px] text-gray-400 font-bold tracking-widest mb-1">VISITANTE</span>
                        <div class="w-14 h-14 rounded-full bg-white border border-purple-100 p-1 shadow-md mb-2 flex items-center justify-center">
                            <img src="${visitUrl}" class="w-full h-full object-contain">
                        </div>
                        <span class="text-[10px] font-bold text-center leading-tight text-slate-800">${m.visitName}</span>
                    </div>
                </div>
                
                <div class="flex gap-2 mt-4">
                    <button onclick="downloadICS()" class="flex-1 flex items-center justify-center gap-2 py-3 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 text-xs font-bold rounded-xl transition-colors border border-indigo-100">
                        <i class="fa-regular fa-calendar-plus text-lg"></i> Añadir
                    </button>
                    <a href="${m.direccion}" target="_blank" class="flex-[2] flex items-center justify-center gap-2 py-3 bg-slate-50 hover:bg-slate-100 text-slate-600 text-xs font-bold rounded-xl transition-colors border border-slate-100 truncate px-2" title="${m.addressText}">
                        <i class="fa-solid fa-location-dot text-red-500 text-lg shrink-0"></i> <span class="truncate">${addressDisplay}</span>
                    </a>
                </div>
            `;
        }

        function downloadICS() {
            if (!currentNextMatch) return;
            const m = currentNextMatch;
            
            const [day, month, year] = m.fecha.split('/');
            const fullYear = year.length === 2 ? '20' + year : year;
            const [hour, minute] = m.hora.split(':');
            
            const startDate = `${fullYear}${month}${day}T${hour}${minute}00`;
            
            let endHour = parseInt(hour) + 1;
            const endDate = `${fullYear}${month}${day}T${endHour.toString().padStart(2,'0')}${minute}00`;
            
            const title = `Fútbol Sala: ${m.localName} vs ${m.visitName}`;
            const description = `Jornada ${m.jornada} - Alevín Mixto ECMadrid`;
            
            // USAR LA DIRECCIÓN REAL EN EL ICS
            const location = m.addressText || 'Campo de juego';

            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//ValleSanchinarro//App//ES
BEGIN:VEVENT
UID:${Date.now()}@valle.app
DTSTAMP:${startDate}Z
DTSTART:${startDate}
DTEND:${endDate}
SUMMARY:${title}
DESCRIPTION:${description}
LOCATION:${location}
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.setAttribute('download', 'partido_valle.ics');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function switchTab(tab) {
            document.getElementById('view-clasificacion').classList.toggle('hidden', tab !== 'clasificacion');
            document.getElementById('view-resultados').classList.toggle('hidden', tab !== 'resultados');
            const btnClasif = document.getElementById('tab-clasif');
            const btnRes = document.getElementById('tab-res');
            if(tab === 'clasificacion') {
                btnClasif.className = 'flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-active';
                btnRes.className = 'flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-inactive hover:bg-slate-50';
            } else {
                btnRes.className = 'flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-active';
                btnClasif.className = 'flex-1 py-3 rounded-xl text-sm font-bold transition-all duration-300 tab-inactive hover:bg-slate-50';
            }
        }
    </script>
</body>
</html>